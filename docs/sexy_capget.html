<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> üìö CAPGET, Manual </title>
    <link href="./index.css" rel="stylesheet">
</head>

<body>
    <header class="nav-header">
        <a href="./index.html" class="home-button">üè† Home</a>
    </header>
    <article>
        <div><h1>üìö CAPGET, Manual</h1><blockquote>*Beautiful, readable documentation for command-line tools*</blockquote><hr></hr><p>[<a href="./capget.html">capget(2)</a>](capget.html)                                                                                   System Calls Manual                                                                                   [<a href="./capget.html">capget(2)</a>](capget.html)</p><h2>üìë Table of Contents</h2><p>- <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001.">Posix.1-2001.</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a> - <a href="#authors">Authors</a> - <a href="#see-also">See Also</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#availability">Availability</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a> - <a href="#files">Files</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a>   - <a href="#target">Target</a> - <a href="#description">Description</a> - <a href="#options">Options</a> - <a href="#see-also">See Also</a>   - <a href="#copyright">Copyright</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#environment">Environment</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a> - <a href="#authors">Authors</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#exit-status">Exit Status</a> - <a href="#environment">Environment</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a>   - <a href="#history">History</a>   - <a href="#bugs">Bugs</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#c11,-posix.1-2008.">C11, Posix.1-2008.</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#seccomp_ret_errno">Seccomp_Ret_Errno</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a></p><h2 id="name">Name</h2><pre><code>capget, capset - set/get capabilities of thread(s)
</code></pre><h3 id="library">Library</h3><pre><code>Standard C library (libc, -lc)
</code></pre><h2 id="synopsis">Synopsis</h2><p>` #include <linux/capability.h> /* Definition of CAP_* and                                  _LINUX_CAPABILITY_* constants */ #include <sys/syscall.h>      /* Definition of SYS_* constants */ #include <unistd.h></p><p>int syscall(SYS_capget, cap_user_header_t hdrp,             cap_user_data_t datap); int syscall(SYS_capset, cap_user_header_t hdrp,             const cap_user_data_t datap);</p><p>Note: glibc provides no wrappers for these system calls, necessitating the use of <a href="./syscall.html">syscall(2)</a>. `</p><h2 id="description">Description</h2><p>` These  two system calls are the raw kernel interface for getting and setting thread capabilities.  Not only are these system calls specific to Linux, but the kernel API is likely to change and use of these system calls (in particular the format of the cap_user_*_t types) is subject to extension with each kernel revision, but old programs will keep working.</p><p>The portable interfaces are <a href="./cap_set_proc.html">cap_set_proc(3)</a> and <a href="./cap_get_proc.html">cap_get_proc(3)</a>; if possible, you should use those interfaces in applications; see NOTES. `</p><p>Current details ` Now that you have been warned, some current kernel details.  The structures are defined as follows.</p><p>#define _LINUX_CAPABILITY_VERSION_1  0x19980330     #define _LINUX_CAPABILITY_U32S_1     1</p><p>/* V2 added in Linux 2.6.25; deprecated */     #define _LINUX_CAPABILITY_VERSION_2  0x20071026     #define _LINUX_CAPABILITY_U32S_2     2</p><p>/* V3 added in Linux 2.6.26 */     #define _LINUX_CAPABILITY_VERSION_3  0x20080522     #define _LINUX_CAPABILITY_U32S_3     2</p><p>typedef struct __user_cap_header_struct {        __u32 version;        int pid;     } *cap_user_header_t;</p><p>typedef struct __user_cap_data_struct {        __u32 effective;        __u32 permitted;        __u32 inheritable;     } *cap_user_data_t;</p><p>The effective, permitted, and inheritable fields are bit masks of the capabilities defined in <a href="./capabilities.html">capabilities(7)</a>.  Note that the CAP_* values are bit indexes and need to be bit-shifted  before  ORing into  the bit fields.  To define the structures for passing to the system call, you have to use the struct __user_cap_header_struct and struct __user_cap_data_struct names because the typedefs are only pointers.</p><p>Kernels prior to Linux 2.6.25 prefer 32-bit capabilities with version _LINUX_CAPABILITY_VERSION_1.  Linux 2.6.25 added 64-bit capability sets, with version _LINUX_CAPABILITY_VERSION_2.  There was, however, an API glitch, and Linux 2.6.26 added _LINUX_CAPABILITY_VERSION_3 to fix the problem.</p><p>Note that 64-bit capabilities use datap[0] and datap[1], whereas 32-bit capabilities use only datap[0].</p><p>On kernels that support file capabilities (VFS capabilities support), these system calls behave slightly differently.  This support was added as an option in Linux 2.6.24, and became fixed (nonop‚Äê tional) in Linux 2.6.33.</p><p>For capget() calls, one can probe the capabilities of any process by specifying its process ID with the hdrp->pid field value.</p><p>For details on the data, see <a href="./capabilities.html">capabilities(7)</a>. `</p><p>With VFS capabilities support <code> VFS capabilities employ a file extended attribute (see [xattr(7)](./xattr.html)) to allow capabilities to be attached to executables.  This privilege model obsoletes kernel support for one process  asynchronously setting  the  capabilities of another.  That is, on kernels that have VFS capabilities support, when calling capset(), the only permitted values for hdrp->pid are 0 or, equivalently, the value re‚Äê turned by [gettid(2)](./gettid.html). </code></p><p>Without VFS capabilities support <code> On older kernels that do not provide VFS capabilities support capset() can, if the caller has the CAP_SETPCAP capability, be used to change not only the caller's own capabilities, but also the ca‚Äê pabilities of other threads.  The call operates on the capabilities of the thread specified by the pid field of hdrp when that is nonzero, or on the capabilities of the calling thread if pid is 0. If pid refers to a single-threaded process, then pid can be specified as a traditional process ID; operating on a thread of a multithreaded process requires a thread ID of  the  type  returned  by [gettid(2)](./gettid.html).   For capset(), pid can also be: -1, meaning perform the change on all threads except the caller and [init(1)](./init.html); or a value less than -1, in which case the change is applied to all members of the process group whose ID is -pid. </code></p><h3 id="return-value">Return Value</h3><p>` On success, zero is returned.  On error, -1 is returned, and errno is set to indicate the error.</p><p>The calls fail with the error EINVAL, and set the version field of hdrp to the kernel preferred value of _LINUX_CAPABILITY_VERSION_?  when an unsupported version value is specified.  In this  way, one can probe what the current preferred capability revision is. `</p><h3 id="errors">Errors</h3><p>` EFAULT Bad memory address.  hdrp must not be NULL.  datap may be NULL only when the user is trying to determine the preferred capability version format supported by the kernel.</p><p>EINVAL One of the arguments was invalid.</p><p>EPERM  An attempt was made to add a capability to the permitted set, or to set a capability in the effective set that is not in the permitted set.</p><p>EPERM  An attempt was made to add a capability to the inheritable set, and either: `</p><p>‚Ä¢  that capability was not in the caller's bounding set; or</p><p>‚Ä¢  the capability was not in the caller's permitted set and the caller lacked the CAP_SETPCAP capability in its effective set.</p><p>` EPERM  The  caller attempted to use capset() to modify the capabilities of a thread other than itself, but lacked sufficient privilege.  For kernels supporting VFS capabilities, this is never per‚Äê        mitted.  For kernels lacking VFS support, the CAP_SETPCAP capability is required.  (A bug in kernels before Linux 2.6.11 meant that this error could also occur if a thread without this  ca‚Äê        pability tried to change its own capabilities by specifying the pid field as a nonzero value (i.e., the value returned by <a href="./getpid.html">getpid(2)</a>) instead of 0.)</p><p>ESRCH  No such thread. `</p><h3 id="standards">Standards</h3><pre><code>Linux.
</code></pre><h3 id="notes">Notes</h3><pre><code>The portable interface to the capability querying and setting functions is provided by the libcap library and is available here:
http://git.kernel.org/cgit/linux/kernel/git/morgan/libcap.git
</code></pre><h2 id="see-also">See Also</h2><pre><code>clone(2), gettid(2), capabilities(7)
</code></pre><p>Linux man-pages 6.7                                                                              2023-10-31                                                                                       [<a href="./capget.html">capget(2)</a>](capget.html)</p></div>
    </article>
</body>

</html>
