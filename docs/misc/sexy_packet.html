<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> üìö PACKET Manual </title>
    <link href="./index.css" rel="stylesheet">
</head>

<body>
    <header class="nav-header">
        <a href="./index.html" class="home-button">üè† Home</a>
    </header>
    <article>
        <div><h1>üìö PACKET Manual</h1><blockquote>*Beautiful, readable documentation for command-line tools*</blockquote><hr></hr><p>[<a href="./packet.html">packet(7)</a>](packet.html)              Miscellaneous Information Manual              [<a href="./packet.html">packet(7)</a>](packet.html)</p><h2>üìë Table of Contents</h2><p>- <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#bugs">Bugs</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001.">Posix.1-2001.</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a> - <a href="#authors">Authors</a> - <a href="#see-also">See Also</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#availability">Availability</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#configuration">Configuration</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a> - <a href="#files">Files</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#c11,-posix.1-2008.">C11, Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001,-c99.">Posix.1-2001, C99.</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a>   - <a href="#target">Target</a> - <a href="#description">Description</a> - <a href="#options">Options</a> - <a href="#see-also">See Also</a>   - <a href="#copyright">Copyright</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#environment">Environment</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a> - <a href="#authors">Authors</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#exit-status">Exit Status</a> - <a href="#environment">Environment</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a>   - <a href="#history">History</a>   - <a href="#bugs">Bugs</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#c11,-posix.1-2008.">C11, Posix.1-2008.</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#seccomp_ret_errno">Seccomp_Ret_Errno</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#keys">Keys</a>   - <a href="#exit-status">Exit Status</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001.">Posix.1-2001.</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#arguments">Arguments</a> - <a href="#options">Options</a> - <a href="#see-also">See Also</a>   - <a href="#url">Url</a> - <a href="#authors">Authors</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#exit-status">Exit Status</a> - <a href="#environment">Environment</a> - <a href="#files">Files</a>   - <a href="#notes">Notes</a>   - <a href="#nfs">Nfs</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#availability">Availability</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#exit-codes">Exit Codes</a> - <a href="#see-also">See Also</a> - <a href="#examples">Examples</a> - <a href="#authors">Authors</a>   - <a href="#copyright">Copyright</a>   - <a href="#notes">Notes</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#exit-codes">Exit Codes</a> - <a href="#files">Files</a> - <a href="#environment">Environment</a>   - <a href="#lang,-language,-lc_ctype,-lc_numeric,-lc_time,-lc_collate,-lc_monetary,-lc_messages,-lc_paper,-lc_name,-lc_address,-lc_telephone,-lc_measurement,-lc_identification,-lc_all,-term,-path">Lang, Language, Lc_Ctype, Lc_Numeric, Lc_Time, Lc_Collate, Lc_Monetary, Lc_Messages, Lc_Paper, Lc_Name, Lc_Address, Lc_Telephone, Lc_Measurement, Lc_Identification, Lc_All, Term, Path</a> - <a href="#see-also">See Also</a>   - <a href="#author">Author</a>   - <a href="#copyright">Copyright</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#versions">Versions</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001.">Posix.1-2001.</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#parsing">Parsing</a>   - <a href="#output">Output</a>   - <a href="#quoting">Quoting</a>   - <a href="#scanning-modes">Scanning Modes</a>   - <a href="#compatibility">Compatibility</a>   - <a href="#return-codes">Return Codes</a> - <a href="#examples">Examples</a> - <a href="#environment">Environment</a>   - <a href="#posixly_correct">Posixly_Correct</a>   - <a href="#getopt_compatible">Getopt_Compatible</a>   - <a href="#bugs">Bugs</a>   - <a href="#author">Author</a> - <a href="#see-also">See Also</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#availability">Availability</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#c11,-posix.1-2008.">C11, Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001,-c99.">Posix.1-2001, C99.</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#regular-expressions">Regular Expressions</a>   - <a href="#exit-status">Exit Status</a> - <a href="#environment">Environment</a>   - <a href="#notes">Notes</a>   - <a href="#copyright">Copyright</a>   - <a href="#bugs">Bugs</a>   - <a href="#example">Example</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#description">Description</a>   - <a href="#ascii">Ascii</a>   - <a href="#iso-iec-8859">Iso/Iec 8859</a>   - <a href="#koi8-r---koi8-u">Koi8-R / Koi8-U</a>   - <a href="#gb-2312">Gb 2312</a>   - <a href="#jis-x-0208">Jis X 0208</a>   - <a href="#ks-x-1001">Ks X 1001</a>   - <a href="#tis-620">Tis-620</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#interactive-commands">Interactive Commands</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#notes">Notes</a> - <a href="#examples">Examples</a> - <a href="#authors">Authors</a> - <a href="#see-also">See Also</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#availability">Availability</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#files">Files</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a> - <a href="#files">Files</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#configuration">Configuration</a> - <a href="#files">Files</a>   - <a href="#exit-values">Exit Values</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#examples">Examples</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#pollout">Pollout</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#o_noctty">O_Noctty</a>   - <a href="#o_nofollow">O_Nofollow</a>   - <a href="#o_trunc">O_Trunc</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#nfs">Nfs</a>   - <a href="#o_direct">O_Direct</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#description">Description</a>   - <a href="#notes">Notes</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#caveats">Caveats</a> - <a href="#files">Files</a>   - <a href="#exit-values">Exit Values</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#compatibility">Compatibility</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#availability">Availability</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#description">Description</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#command-synopsis">Command Synopsis</a>   - <a href="#regular-expressions">Regular Expressions</a>   - <a href="#bugs">Bugs</a>   - <a href="#author">Author</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#description">Description</a>   - <a href="#sudoers-file-format">Sudoers File Format</a>   - <a href="#sudoers-options">Sudoers Options</a>   - <a href="#group-provider-plugins">Group Provider Plugins</a>   - <a href="#event-logging">Event Logging</a>   - <a href="#i-o-logging">I/O Logging</a> - <a href="#files">Files</a> - <a href="#examples">Examples</a>   - <a href="#security-notes">Security Notes</a>   - <a href="#debugging">Debugging</a> - <a href="#see-also">See Also</a> - <a href="#authors">Authors</a>   - <a href="#caveats">Caveats</a>   - <a href="#bugs">Bugs</a>   - <a href="#support">Support</a>   - <a href="#disclaimer">Disclaimer</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#caveats">Caveats</a>   - <a href="#configuration">Configuration</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001.">Posix.1-2001.</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#nfs">Nfs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#commands">Commands</a> - <a href="#options">Options</a>   - <a href="#exit-status">Exit Status</a> - <a href="#examples">Examples</a> - <a href="#environment">Environment</a>   - <a href="#$systemd_log_level">$Systemd_Log_Level</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#c11,-posix.1-2008.">C11, Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001,-c99.">Posix.1-2001, C99.</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#commands">Commands</a>   - <a href="#display-names">Display Names</a>   - <a href="#example">Example</a> - <a href="#environment">Environment</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a>   - <a href="#bugs">Bugs</a>   - <a href="#author">Author</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#standards">Standards</a>   - <a href="#caveats">Caveats</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#eaddrnotavail">Eaddrnotavail</a>   - <a href="#eaddrnotavail">Eaddrnotavail</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#versions">Versions</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#posix.1-2001.">Posix.1-2001.</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#sort-criteria">Sort Criteria</a>   - <a href="#commands">Commands</a> - <a href="#files">Files</a> - <a href="#see-also">See Also</a>   - <a href="#notes">Notes</a> - <a href="#authors">Authors</a>   - <a href="#reporting-bugs">Reporting Bugs</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#standards">Standards</a>   - <a href="#caveats">Caveats</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#bugs">Bugs</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#description">Description</a>   - <a href="#locking">Locking</a> - <a href="#see-also">See Also</a>   - <a href="#history">History</a> - <a href="#authors">Authors</a>   - <a href="#bugs">Bugs</a>   - <a href="#support">Support</a>   - <a href="#disclaimer">Disclaimer</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#author">Author</a>   - <a href="#reporting-bugs">Reporting Bugs</a>   - <a href="#copyright">Copyright</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#caveats">Caveats</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a> - <a href="#files">Files</a> - <a href="#examples">Examples</a> - <a href="#see-also">See Also</a> - <a href="#authors">Authors</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#posix.1-2008.">Posix.1-2008.</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#syntax">Syntax</a> - <a href="#description">Description</a> - <a href="#options">Options</a>   - <a href="#numbers">Numbers</a>   - <a href="#variables">Variables</a>   - <a href="#comments">Comments</a>   - <a href="#expressions">Expressions</a>   - <a href="#statements">Statements</a>   - <a href="#pseudo-statements">Pseudo Statements</a>   - <a href="#functions">Functions</a>   - <a href="#math-library">Math Library</a> - <a href="#examples">Examples</a>   - <a href="#readline-and-libedit-options">Readline And Libedit Options</a>   - <a href="#differences">Differences</a>   - <a href="#limits">Limits</a>   - <a href="#environment-variables">Environment Variables</a>   - <a href="#diagnostics">Diagnostics</a>   - <a href="#bugs">Bugs</a>   - <a href="#author">Author</a>   - <a href="#acknowledgements">Acknowledgements</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#o_noctty">O_Noctty</a>   - <a href="#o_nofollow">O_Nofollow</a>   - <a href="#o_trunc">O_Trunc</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#nfs">Nfs</a>   - <a href="#o_direct">O_Direct</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a>   - <a href="#library">Library</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#return-value">Return Value</a>   - <a href="#errors">Errors</a>   - <a href="#attributes">Attributes</a>   - <a href="#versions">Versions</a>   - <a href="#versions">Versions</a>   - <a href="#standards">Standards</a>   - <a href="#history">History</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a> - <a href="#name">Name</a> - <a href="#synopsis">Synopsis</a> - <a href="#description">Description</a>   - <a href="#errors">Errors</a>   - <a href="#eaddrnotavail">Eaddrnotavail</a>   - <a href="#versions">Versions</a>   - <a href="#notes">Notes</a>   - <a href="#bugs">Bugs</a> - <a href="#see-also">See Also</a></p><h2 id="name">Name</h2><pre><code>packet - packet interface on device level
</code></pre><h2 id="synopsis">Synopsis</h2><p>` #include <sys/socket.h> #include <linux/if_packet.h> #include <net/ethernet.h> /* the L2 protocols */</p><p>packet_socket = socket(AF_PACKET, int socket_type, int protocol); `</p><h2 id="description">Description</h2><p>` Packet  sockets  are  used to receive or send raw packets at the device driver (OSI Layer 2) level.  They allow the user to implement  protocol modules in user space on top of the physical layer.</p><p>The  socket_type is either SOCK_RAW for raw packets including the link- level header or SOCK_DGRAM  for  cooked  packets  with  the  link-level header  removed.   The  link-level header information is available in a common format in a sockaddr_ll structure.  protocol is the  IEEE  802.3 protocol  number in network byte order.  See the <linux/if_ether.h> in‚Äê clude file for a list of allowed protocols.  When protocol  is  set  to htons(ETH_P_ALL),  then all protocols are received.  All incoming pack‚Äê ets of that protocol type will be passed to the  packet  socket  before they  are passed to the protocols implemented in the kernel.  If proto‚Äê col is set to zero, no packets are received.  <a href="./bind.html">bind(2)</a> can optionally be called with a nonzero sll_protocol to start receiving packets  for  the protocols specified.</p><p>In order to create a packet socket, a process must have the CAP_NET_RAW capability in the user namespace that governs its network namespace.</p><p>SOCK_RAW  packets  are passed to and from the device driver without any changes in the packet data.  When receiving a packet,  the  address  is still  parsed  and  passed in a standard sockaddr_ll address structure. When transmitting a packet, the user-supplied buffer should contain the physical-layer header.  That packet is then queued  unmodified  to  the network  driver  of  the  interface defined by the destination address. Some device drivers always add other headers.  SOCK_RAW is  similar  to but not compatible with the obsolete AF_INET/SOCK_PACKET of Linux 2.0.</p><p>SOCK_DGRAM operates on a slightly higher level.  The physical header is removed  before the packet is passed to the user.  Packets sent through a SOCK_DGRAM packet socket get a suitable physical-layer  header  based on  the  information in the sockaddr_ll destination address before they are queued.</p><p>By default, all packets of the specified protocol type are passed to  a packet  socket.   To  get  packets  only  from a specific interface use <a href="./bind.html">bind(2)</a> specifying an address in  a  struct  sockaddr_ll  to  bind  the packet  socket to an interface.  Fields used for binding are sll_family (should be AF_PACKET), sll_protocol, and sll_ifindex.</p><p>The <a href="./connect.html">connect(2)</a> operation is not supported on packet sockets.</p><p>When  the  MSG_TRUNC  flag  is  passed  to  <a href="./recvmsg.html">recvmsg(2)</a>,   <a href="./recv.html">recv(2)</a>,   or <a href="./recvfrom.html">recvfrom(2)</a>,  the  real  length of the packet on the wire is always re‚Äê turned, even when it is longer than the buffer. `</p><p>Address types ` The sockaddr_ll structure is a  device-independent  physical-layer  ad‚Äê dress.</p><p>struct sockaddr_ll {         unsigned short sll_family;   /* Always AF_PACKET */         unsigned short sll_protocol; /* Physical-layer protocol */         int            sll_ifindex;  /* Interface number */         unsigned short sll_hatype;   /* ARP hardware type */         unsigned char  sll_pkttype;  /* Packet type */         unsigned char  sll_halen;    /* Length of address */         unsigned char  sll_addr[8];  /* Physical-layer address */     };</p><p>The fields of this structure are as follows:</p><p>sll_protocol        is  the standard ethernet protocol type in network byte order as        defined in the <linux/if_ether.h> include file.  It defaults  to        the socket's protocol.</p><p>sll_ifindex        is  the  interface  index of the interface (see <a href="./netdevice.html">netdevice(7)</a>); 0        matches any interface (only permitted for binding).   sll_hatype        is an ARP type as defined in the <linux/if_arp.h> include file.</p><p>sll_pkttype        contains  the  packet  type.   Valid types are PACKET_HOST for a        packet addressed to the local host, PACKET_BROADCAST for a phys‚Äê        ical-layer broadcast packet, PACKET_MULTICAST for a packet  sent        to  a  physical-layer  multicast address, PACKET_OTHERHOST for a        packet to some other host that has been caught by a device  dri‚Äê        ver in promiscuous mode, and PACKET_OUTGOING for a packet origi‚Äê        nating  from  the  local  host  that  is looped back to a packet        socket.  These types make sense only for receiving.</p><p>sll_addr sll_halen        contain the physical-layer (e.g., IEEE 802.3)  address  and  its        length.  The exact interpretation depends on the device.</p><p>When  you  send  packets, it is enough to specify sll_family, sll_addr, sll_halen, sll_ifindex, and sll_protocol.  The other fields  should  be 0.  sll_hatype and sll_pkttype are set on received packets for your in‚Äê formation. `</p><p>Socket options ` Packet  socket  options  are  configured  by calling <a href="./setsockopt.html">setsockopt(2)</a> with level SOL_PACKET.</p><p>PACKET_ADD_MEMBERSHIP PACKET_DROP_MEMBERSHIP        Packet sockets can be used to configure physical-layer multicas‚Äê        ting and promiscuous mode.  PACKET_ADD_MEMBERSHIP adds a binding        and  PACKET_DROP_MEMBERSHIP  drops  it.   They  both  expect   a        packet_mreq structure as argument:</p><p>struct packet_mreq {                int            mr_ifindex;    /* interface index */                unsigned short mr_type;       /* action */                unsigned short mr_alen;       /* address length */                unsigned char  mr_address[8]; /* physical-layer address */            };</p><p>mr_ifindex  contains the interface index for the interface whose        status should be changed.  The mr_type field specifies which ac‚Äê        tion to perform.  PACKET_MR_PROMISC enables receiving all  pack‚Äê        ets  on  a  shared  medium  (often known as "promiscuous mode"),        PACKET_MR_MULTICAST binds the socket to the physical-layer  mul‚Äê        ticast   group   specified   in   mr_address  and  mr_alen,  and        PACKET_MR_ALLMULTI sets the socket up to receive  all  multicast        packets arriving at the interface.</p><p>In  addition, the traditional ioctls SIOCSIFFLAGS, SIOCADDMULTI,        SIOCDELMULTI can be used for the same purpose.</p><p>PACKET_AUXDATA (since Linux 2.6.21)        If this binary option is enabled, the  packet  socket  passes  a        metadata structure along with each packet in the <a href="./recvmsg.html">recvmsg(2)</a> con‚Äê        trol  field.  The structure can be read with <a href="./cmsg.html">cmsg(3)</a>.  It is de‚Äê        fined as</p><p>struct tpacket_auxdata {                __u32 tp_status;                __u32 tp_len;      /* packet length */                __u32 tp_snaplen;  /* captured length */                __u16 tp_mac;                __u16 tp_net;                __u16 tp_vlan_tci;                __u16 tp_vlan_tpid; /* Since Linux 3.14; earlier, these                                       were unused padding bytes */            };</p><p>PACKET_FANOUT (since Linux 3.1)        To scale processing across threads, packet sockets  can  form  a        fanout  group.   In  this mode, each matching packet is enqueued        onto only one socket in the group.   A  socket  joins  a  fanout        group  by calling <a href="./setsockopt.html">setsockopt(2)</a> with level SOL_PACKET and option        PACKET_FANOUT.  Each network namespace can have up to 65536  in‚Äê        dependent  groups.   A socket selects a group by encoding the ID        in the first 16 bits of the integer  option  value.   The  first        packet  socket  to  join a group implicitly creates it.  To suc‚Äê        cessfully join an existing group, subsequent packet sockets must        have the same protocol, device settings, fanout mode, and  flags        (see  below).   Packet  sockets can leave a fanout group only by        closing the socket.  The group is deleted when the  last  socket        is closed.</p><p>Fanout  supports  multiple  algorithms to spread traffic between        sockets, as follows: `</p><p>‚Ä¢  The default mode, PACKET_FANOUT_HASH, sends packets from  the                  same  flow  to the same socket to maintain per-flow ordering.                  For each packet, it chooses a socket  by  taking  the  packet                  flow  hash modulo the number of sockets in the group, where a                  flow hash is a hash over network-layer address  and  optional                  transport-layer port fields.</p><p>‚Ä¢  The  load-balance  mode  PACKET_FANOUT_LB implements a round-                  robin algorithm.</p><p>‚Ä¢  PACKET_FANOUT_CPU selects the socket based on  the  CPU  that                  the packet arrived on.</p><p>‚Ä¢  PACKET_FANOUT_ROLLOVER processes all data on a single socket,                  moving to the next when one becomes backlogged.</p><p>‚Ä¢  PACKET_FANOUT_RND  selects  the  socket using a pseudo-random                  number generator.</p><p>‚Ä¢  PACKET_FANOUT_QM (available since  Linux  3.14)  selects  the                  socket using the recorded queue_mapping of the received skb.</p><p>` Fanout  modes  can  take  additional  options.  IP fragmentation causes packets from the same flow to have different flow hashes. The flag PACKET_FANOUT_FLAG_DEFRAG, if set, causes packets to be defragmented before fanout is applied, to preserve order even in this case.  Fanout mode and options are communicated in the sec‚Äê ond  16  bits  of  the   integer   option   value.    The   flag PACKET_FANOUT_FLAG_ROLLOVER enables the roll over mechanism as a backup  strategy:  if  the  original  fanout algorithm selects a backlogged socket, the packet rolls over to the  next  available one.</p><p>`</p><p>` PACKET_LOSS (with PACKET_TX_RING)        When  a  malformed packet is encountered on a transmit ring, the        default is to reset its tp_status to TP_STATUS_WRONG_FORMAT  and        abort the transmission immediately.  The malformed packet blocks        itself  and  subsequently enqueued packets from being sent.  The        format error must be fixed, the associated  tp_status  reset  to        TP_STATUS_SEND_REQUEST,  and  the transmission process restarted        via <a href="./send.html">send(2)</a>.  However, if  PACKET_LOSS  is  set,  any  malformed        packet  will be skipped, its tp_status reset to TP_STATUS_AVAIL‚Äê        ABLE, and the transmission process continued.</p><p>PACKET_RESERVE (with PACKET_RX_RING)        By default, a packet receive  ring  writes  packets  immediately        following  the  metadata  structure and alignment padding.  This        integer option reserves additional headroom.</p><p>PACKET_RX_RING        Create a memory-mapped ring buffer for asynchronous  packet  re‚Äê        ception.   The packet socket reserves a contiguous region of ap‚Äê        plication address space, lays it out into  an  array  of  packet        slots  and  copies  packets  (up  to tp_snaplen) into subsequent        slots.  Each packet is preceded by a metadata structure  similar        to  tpacket_auxdata.   The  protocol fields encode the offset to        the data from the start of the metadata header.   tp_net  stores        the  offset  to  the  network layer.  If the packet socket is of        type SOCK_DGRAM, then tp_mac is the same.   If  it  is  of  type        SOCK_RAW,  then  that  field stores the offset to the link-layer        frame.  Packet socket and application communicate the  head  and        tail of the ring through the tp_status field.  The packet socket        owns  all slots with tp_status equal to TP_STATUS_KERNEL.  After        filling a slot, it changes the status of the  slot  to  transfer        ownership  to the application.  During normal operation, the new        tp_status value has at least the TP_STATUS_USER bit set to  sig‚Äê        nal  that  a received packet has been stored.  When the applica‚Äê        tion has finished processing a packet, it transfers ownership of        the slot back to  the  socket  by  setting  tp_status  equal  to        TP_STATUS_KERNEL.</p><p>Packet  sockets  implement multiple variants of the packet ring.        The implementation details are described  in  Documentation/net‚Äê        working/packet_mmap.rst in the Linux kernel source tree.</p><p>PACKET_STATISTICS        Retrieve packet socket statistics in the form of a structure</p><p>struct tpacket_stats {                unsigned int tp_packets;  /* Total packet count */                unsigned int tp_drops;    /* Dropped packet count */            };</p><p>Receiving  statistics resets the internal counters.  The statis‚Äê        tics structure differs when using a ring of variant TPACKET_V3.</p><p>PACKET_TIMESTAMP (with PACKET_RX_RING; since Linux 2.6.36)        The packet receive ring always stores a timestamp in  the  meta‚Äê        data header.  By default, this is a software generated timestamp        generated when the packet is copied into the ring.  This integer        option  selects  the type of timestamp.  Besides the default, it        support the two hardware formats described in Documentation/net‚Äê        working/timestamping.rst in the Linux kernel source tree.</p><p>PACKET_TX_RING (since Linux 2.6.31)        Create a memory-mapped  ring  buffer  for  packet  transmission.        This  option is similar to PACKET_RX_RING and takes the same ar‚Äê        guments.  The application writes packets into slots with tp_sta‚Äê        tus equal to TP_STATUS_AVAILABLE and schedules them  for  trans‚Äê        mission  by  changing tp_status to TP_STATUS_SEND_REQUEST.  When        packets are ready  to  be  transmitted,  the  application  calls        <a href="./send.html">send(2)</a>  or  a  variant thereof.  The buf and len fields of this        call are ignored.  If an address is passed  using  <a href="./sendto.html">sendto(2)</a>  or        <a href="./sendmsg.html">sendmsg(2)</a>, then that overrides the socket default.  On success‚Äê        ful   transmission,  the  socket  resets  tp_status  to  TP_STA‚Äê        TUS_AVAILABLE.  It immediately aborts the transmission on  error        unless PACKET_LOSS is set.</p><p>PACKET_VERSION (with PACKET_RX_RING; since Linux 2.6.27)        By  default,  PACKET_RX_RING  creates  a  packet receive ring of        variant TPACKET_V1.  To create another  variant,  configure  the        desired  variant  by setting this integer option before creating        the ring.</p><p>PACKET_QDISC_BYPASS (since Linux 3.14)        By default, packets sent through packet sockets pass through the        kernel's qdisc (traffic control) layer, which is  fine  for  the        vast  majority  of  use cases.  For traffic generator appliances        using packet sockets that intend to brute-force flood  the  net‚Äê        work‚Äîfor  example, to test devices under load in a similar fash‚Äê        ion to pktgen‚Äîthis layer can be bypassed by setting this integer        option to 1.  A side effect is  that  packet  buffering  in  the        qdisc  layer is avoided, which will lead to increased drops when        network device transmit queues are busy; therefore, use at  your        own risk. `</p><p>Ioctls ` SIOCGSTAMP  can  be  used to receive the timestamp of the last received packet.  Argument is a struct timeval variable.</p><p>In addition, all standard ioctls defined in <a href="./netdevice.html">netdevice(7)</a> and  <a href="./socket.html">socket(7)</a> are valid on packet sockets. `</p><p>Error handling <code> Packet  sockets  do  no error handling other than errors occurred while passing the packet to the device driver.  They don't have  the  concept of a pending error. </code></p><h3 id="errors">Errors</h3><h3 id="eaddrnotavail">Eaddrnotavail</h3><p>` Unknown multicast group address passed.</p><p>`</p><p>` EFAULT User passed invalid memory address.</p><p>EINVAL Invalid argument.</p><p>EMSGSIZE        Packet is bigger than interface MTU.</p><p>ENETDOWN        Interface is not up.</p><p>ENOBUFS        Not enough memory to allocate the packet.</p><p>ENODEV Unknown  device  name  or interface index specified in interface        address.</p><p>ENOENT No packet received.</p><p>ENOTCONN        No interface address passed.</p><p>ENXIO  Interface address contained an invalid interface index.</p><p>EPERM  User has insufficient privileges to carry out this operation.</p><p>In addition, other errors may be generated by the low-level driver. `</p><h3 id="versions">Versions</h3><pre><code>AF_PACKET is a new feature in Linux 2.2.  Earlier Linux  versions  sup‚Äê
ported only SOCK_PACKET.
</code></pre><h3 id="notes">Notes</h3><p>` For portable programs it is suggested to use AF_PACKET via <a href="./pcap.html">pcap(3)</a>; al‚Äê though this covers only a subset of the AF_PACKET features.</p><p>The  SOCK_DGRAM  packet  sockets make no attempt to create or parse the IEEE 802.2 LLC header for a IEEE  802.3  frame.   When  ETH_P_802_3  is specified  as  protocol  for sending the kernel creates the 802.3 frame and fills out the length field; the user has to supply the  LLC  header to  get a fully conforming packet.  Incoming 802.3 packets are not mul‚Äê tiplexed on the DSAP/SSAP protocol fields; instead they are supplied to the user as protocol ETH_P_802_2 with the LLC header prefixed.   It  is thus  not  possible to bind to ETH_P_802_3; bind to ETH_P_802_2 instead and do the protocol multiplex yourself.  The default for sending is the standard Ethernet DIX encapsulation with the protocol filled in.</p><p>Packet sockets are not subject to the input or output firewall chains. `</p><p>Compatibility ` In Linux 2.0, the only way to get a packet socket was with the call:</p><p>socket(AF_INET, SOCK_PACKET, protocol)</p><p>This is still supported, but deprecated and strongly discouraged.   The main  difference  between  the two methods is that SOCK_PACKET uses the old struct sockaddr_pkt to specify an interface, which doesn't  provide physical-layer independence.</p><p>struct sockaddr_pkt {         unsigned short spkt_family;         unsigned char  spkt_device[14];         unsigned short spkt_protocol;     };</p><p>spkt_family  contains  the device type, spkt_protocol is the IEEE 802.3 protocol type as defined in <sys/if_ether.h> and spkt_device is the de‚Äê vice name as a null-terminated string, for example, eth0.</p><p>This structure is obsolete and should not be used in new code. `</p><h3 id="bugs">Bugs</h3><p>LLC header handling <code> The IEEE 802.2/803.3 LLC handling could be considered as a bug. </code></p><p>MSG_TRUNC issues <code> The MSG_TRUNC [recvmsg(2)](./recvmsg.html) extension is an ugly hack and  should  be  re‚Äê placed  by  a  control  message.   There is currently no way to get the original destination address of packets via SOCK_DGRAM. </code></p><p>spkt_device device name truncation ` The spkt_device field of sockaddr_pkt has a size of 14 bytes, which  is less than the constant IFNAMSIZ defined in <net/if.h> which is 16 bytes and  describes  the  system  limit  for a network interface name.  This means the names of network devices longer than 14 bytes will  be  trun‚Äê cated to fit into spkt_device.  All these lengths include the terminat‚Äê ing null byte ('\0')).</p><p>Issues  from this with old code typically show up with very long inter‚Äê face names used by the Predictable Network Interface Names feature  en‚Äê abled by default in many modern Linux distributions.</p><p>The preferred solution is to rewrite code to avoid SOCK_PACKET.  Possi‚Äê ble  user  solutions are to disable Predictable Network Interface Names or to rename the interface to a name of at most 13 bytes,  for  example using the <a href="./ip.html">ip(8)</a> tool. `</p><p>Documentation issues <code> Socket filters are not documented. </code></p><h2 id="see-also">See Also</h2><p>` <a href="./socket.html">socket(2)</a>, <a href="./pcap.html">pcap(3)</a>, <a href="./capabilities.html">capabilities(7)</a>, <a href="./ip.html">ip(7)</a>, <a href="./raw.html">raw(7)</a>, <a href="./socket.html">socket(7)</a>, <a href="./ip.html">ip(8)</a>,</p><p>RFC 894  for  the standard IP Ethernet encapsulation.  RFC 1700 for the IEEE 802.3 IP encapsulation.</p><p>The <linux/if_ether.h> include file for physical-layer protocols.</p><p>The Linux kernel source tree.  Documentation/networking/filter.rst  de‚Äê scribes  how  to  apply  Berkeley  Packet  Filters  to  packet sockets. tools/testing/selftests/net/psock_tpacket.c  contains  example   source code for all available versions of PACKET_RX_RING and PACKET_TX_RING. `</p><p>Linux man-pages 6.7               2023-10-31                         [<a href="./packet.html">packet(7)</a>](packet.html)</p></div>
    </article>
</body>

</html>
